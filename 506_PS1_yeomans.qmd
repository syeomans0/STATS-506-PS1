---
title: "STATS 506 - Problem Set #1"
author: "Sydney Yeomans"
format: html
editor: visual
---

## Problem 1

Download the data set about abalones (a type of sea snail) and do the following:

a.  Import the data into a data.frame and give the appropriate column names.

```{r}
#| echo: true
abalones_df <- read.csv("abalone.data", header = FALSE)
head(abalones_df)
```

```{r}
#| echo: true
#Rename the columns based on what is in the abalone name file, names of variables are the following:
#V1 = Sex, V2 = Length, V3 = Diameter, V4 = Height 
#V5 = Whole weight, V6 = Shucked weight, V7 = Viscera weight
#V8 = Shell weight, V9 = Rings

colnames(abalones_df) <- c("Sex", "Length", "Diameter", "Height", 
                           "Whole_weight", "Shucked_weight", "Viscera_weight", "Shell_weight", "Rings")

head(abalones_df)

```

b.  The data contains information on three different sexes of abalone. Report the number of observations belonging to each sex.

```{r}
#| echo: true
table(abalones_df$Sex)
```

In this data set there are 1307 females, 1528 males, and 1342 infants.

c.  

    i.  Which weight has the highest correlation with rings?

```{r}
#| echo: true
#There are four different weights so need four correlations 
whole_cor <- cor(abalones_df$Whole_weight, abalones_df$Rings)
print(whole_cor)

shucked_cor <- cor(abalones_df$Shucked_weight, abalones_df$Rings)
print(shucked_cor)

viscera_cor <- cor(abalones_df$Viscera_weight, abalones_df$Rings)
print(viscera_cor)

shell_cor <- cor(abalones_df$Shell_weight, abalones_df$Rings)
print(shell_cor)
```

The weight with the highest correlation to rings is shell weight with a value of $.627$.

ii. For that weight, which sex has the highest correlation?

```{r}
#| echo: true
#Split the data set into three separate ones based on sex
males <- abalones_df[abalones_df$Sex == "M", ]
females <- abalones_df[abalones_df$Sex == "F", ]
infants <- abalones_df[abalones_df$Sex == "I", ]

#Now we can do the correlations for each for shell weight and rings
male_cor_shell <- cor(males$Shell_weight, males$Rings)
print(male_cor_shell)
female_cor_shell <- cor(females$Shell_weight, females$Rings)
print(female_cor_shell)
infant_cor_shell <- cor(infants$Shell_weight, infants$Rings)
print(infant_cor_shell)

```

The sex with the highest correlation between shell weight and rings is infants.

Source: <https://stackoverflow.com/questions/43347110/how-to-create-new-dataframe-from-existing-dataframe-selecting-rows-matching-two>

iii. What are the weights of the abalone with the most rings?

```{r}
#| echo: true

most_rings <- abalones_df[abalones_df$Rings == max(abalones_df$Rings),]
print(most_rings)

```

The most number of rings for an abalone in this data set is $29$. The weights of the abalone with this many rings is in the table above, but just in case I will list them out as well: whole_weight $=1.8075$, shucked_weight $=.7055$, viscera_weight $=.3215$, and shell_weight $=.475$.

Note: originally had the `max` function on its own, but the output looked bad so I moved it to the inside of the new data frame I created.

Source: <https://stackoverflow.com/questions/24212739/how-to-find-the-highest-value-of-a-column-in-a-data-frame-in-r>

iv. What percentage of abalones have a viscera weight larger than their shell weight?

```{r}
#| echo: true
```

d. Create a table of correlations between weights and rings, within each sex. The columns should be the four weights, and the rows should be the sexes. 

```{r}
#| echo: true
#Have to find the correlations for each of the other weights: whole, shucked, and viscera within each sex
males_cor_whole <- cor(males$Whole_weight, males$Rings)
females_cor_whole <- cor(females$Whole_weight, females$Rings)
infants_cor_whole <- cor(infants$Whole_weight, infants$Rings)
  
males_cor_shucked <- cor(males$Shucked_weight, males$Rings)
females_cor_shucked <- cor(females$Shucked_weight, females$Rings)
infants_cor_shucked <- cor(infants$Shucked_weight, infants$Rings)

males_cor_viscera <- cor(males$Viscera_weight, males$Rings)
females_cor_viscera <- cor(females$Viscera_weight, females$Rings)
infants_cor_viscera <- cor(infants$Viscera_weight, infants$Rings)
  
  
#Create a table with these values: columns = weights, rows = sex
cor_table <- data.frame(whole_weight = c(males_cor_whole, females_cor_whole, infants_cor_whole), shucked_weight = c(males_cor_shucked, females_cor_shucked, infants_cor_shucked), viscera_weight = c(males_cor_viscera, females_cor_viscera, infants_cor_viscera), shell_weight = c(male_cor_shell,female_cor_shell, infant_cor_shell))
row.names(cor_table) <- c("Males", "Females", "Infants")

cor_table
  
```

e. Carry out a series of t-tests to examine whether the number of rings differs across the three sexes. Present the R output and interpret the results. 

```{r}
#| echo: true
```

## Problem 2

a.  

```{r}
#| echo: true
```

b.  

```{r}
#| echo: true
```

c.  

```{r}
#| echo: true
```

d.  

```{r}
#| echo: true
```

e.  

```{r}
#| echo: true
```

f.  

```{r}
#| echo: true
```

h.  

```{r}
#| echo: true
```

## Problem 3

a.  

```{r}
#| echo: true
```

b.  

```{r}
#| echo: true
```

c.  

```{r}
#| echo: true
```
